name: Android CI

on:
  push:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: '17'

    - name: Give gradlew permission
      run: chmod +x ./gradlew

- name: Notify via Telegram on Failure

  if: failure()

  run: |

    curl -s -X POST https://api.telegram.org/bot7798688149:AAHvjk1uDJSxXuX03_GuKAa7ClNYKpp93j8/sendMessage \

      -d chat_id=6817339254 \

      -d text="❌ CodeEditor98: Build failed in GitHub Actions. Check logs: https://github.com/hxjdjkzfh/CodeEditor98/actions"

    - name: Build APK
      run: ./gradlew assembleDebug

    - name: Send APK to Telegram
      run: |
        curl -F document=@app/build/outputs/apk/debug/app-debug.apk              -F chat_id=6817339254              -F caption="CodeEditor98: новая сборка .apk с GitHub"              https://api.telegram.org/bot7798688149:AAHvjk1uDJSxXuX03_GuKAa7ClNYKpp93j8/sendDocument
